<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>aws_lambda_powertools.utilities.batch API documentation</title>
<meta name="description" content="Batch processing utility" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>aws_lambda_powertools.utilities.batch</code></h1>
</header>
<section id="section-intro">
<p>Batch processing utility</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-

&#34;&#34;&#34;
Batch processing utility
&#34;&#34;&#34;

from .base import BasePartialProcessor, batch_processor
from .sqs import PartialSQSProcessor, sqs_batch_processor

__all__ = (&#34;BasePartialProcessor&#34;, &#34;PartialSQSProcessor&#34;, &#34;batch_processor&#34;, &#34;sqs_batch_processor&#34;)</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="aws_lambda_powertools.utilities.batch.base" href="base.html">aws_lambda_powertools.utilities.batch.base</a></code></dt>
<dd>
<div class="desc"><p>Batch processing utilities</p></div>
</dd>
<dt><code class="name"><a title="aws_lambda_powertools.utilities.batch.exceptions" href="exceptions.html">aws_lambda_powertools.utilities.batch.exceptions</a></code></dt>
<dd>
<div class="desc"><p>Batch processing exceptions</p></div>
</dd>
<dt><code class="name"><a title="aws_lambda_powertools.utilities.batch.sqs" href="sqs.html">aws_lambda_powertools.utilities.batch.sqs</a></code></dt>
<dd>
<div class="desc"><p>Batch SQS utilities</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="aws_lambda_powertools.utilities.batch.batch_processor"><code class="name flex">
<span>def <span class="ident">batch_processor</span></span>(<span>handler: Callable, event: Dict[~KT, ~VT], context: Dict[~KT, ~VT], record_handler: Callable, processor: <a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor">BasePartialProcessor</a>)</span>
</code></dt>
<dd>
<div class="desc"><p>Middleware to handle batch event processing</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>handler</code></strong> :&ensp;<code>Callable</code></dt>
<dd>Lambda's handler</dd>
<dt><strong><code>event</code></strong> :&ensp;<code>Dict</code></dt>
<dd>Lambda's Event</dd>
<dt><strong><code>context</code></strong> :&ensp;<code>Dict</code></dt>
<dd>Lambda's Context</dd>
<dt><strong><code>record_handler</code></strong> :&ensp;<code>Callable</code></dt>
<dd>Callable to process each record from the batch</dd>
<dt><strong><code>processor</code></strong> :&ensp;<code><a title="aws_lambda_powertools.utilities.batch.PartialSQSProcessor" href="#aws_lambda_powertools.utilities.batch.PartialSQSProcessor">PartialSQSProcessor</a></code></dt>
<dd>Batch Processor to handle partial failure cases</dd>
</dl>
<h2 id="examples">Examples</h2>
<p><strong>Processes Lambda's event with PartialSQSProcessor</strong></p>
<pre><code>&gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import batch_processor, PartialSQSProcessor
&gt;&gt;&gt;
&gt;&gt;&gt; def record_handler(record):
&gt;&gt;&gt;     return record["body"]
&gt;&gt;&gt;
&gt;&gt;&gt; @batch_processor(record_handler=record_handler, processor=PartialSQSProcessor())
&gt;&gt;&gt; def handler(event, context):
&gt;&gt;&gt;     return {"StatusCode": 200}
</code></pre>
<h2 id="limitations">Limitations</h2>
<ul>
<li>Async batch processors</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lambda_handler_decorator
def batch_processor(
    handler: Callable, event: Dict, context: Dict, record_handler: Callable, processor: BasePartialProcessor
):
    &#34;&#34;&#34;
    Middleware to handle batch event processing

    Parameters
    ----------
    handler: Callable
        Lambda&#39;s handler
    event: Dict
        Lambda&#39;s Event
    context: Dict
        Lambda&#39;s Context
    record_handler: Callable
        Callable to process each record from the batch
    processor: PartialSQSProcessor
        Batch Processor to handle partial failure cases

    Examples
    --------
    **Processes Lambda&#39;s event with PartialSQSProcessor**

        &gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import batch_processor, PartialSQSProcessor
        &gt;&gt;&gt;
        &gt;&gt;&gt; def record_handler(record):
        &gt;&gt;&gt;     return record[&#34;body&#34;]
        &gt;&gt;&gt;
        &gt;&gt;&gt; @batch_processor(record_handler=record_handler, processor=PartialSQSProcessor())
        &gt;&gt;&gt; def handler(event, context):
        &gt;&gt;&gt;     return {&#34;StatusCode&#34;: 200}

    Limitations
    -----------
    * Async batch processors

    &#34;&#34;&#34;
    records = event[&#34;Records&#34;]

    with processor(records, record_handler):
        processor.process()

    return handler(event, context)</code></pre>
</details>
</dd>
<dt id="aws_lambda_powertools.utilities.batch.sqs_batch_processor"><code class="name flex">
<span>def <span class="ident">sqs_batch_processor</span></span>(<span>handler: Callable, event: Dict[~KT, ~VT], context: Dict[~KT, ~VT], record_handler: Callable, config: Optional[botocore.config.Config] = None, suppress_exception: bool = False, boto3_session: Optional[boto3.session.Session] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Middleware to handle SQS batch event processing</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>handler</code></strong> :&ensp;<code>Callable</code></dt>
<dd>Lambda's handler</dd>
<dt><strong><code>event</code></strong> :&ensp;<code>Dict</code></dt>
<dd>Lambda's Event</dd>
<dt><strong><code>context</code></strong> :&ensp;<code>Dict</code></dt>
<dd>Lambda's Context</dd>
<dt><strong><code>record_handler</code></strong> :&ensp;<code>Callable</code></dt>
<dd>Callable to process each record from the batch</dd>
<dt><strong><code>config</code></strong> :&ensp;<code>Config</code></dt>
<dd>botocore config object</dd>
<dt><strong><code>suppress_exception</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Supress exception raised if any messages fail processing, by default False</dd>
<dt><strong><code>boto3_session</code></strong> :&ensp;<code>boto3.session.Session</code>, optional</dt>
<dd>Boto3 session to use for AWS API communication</dd>
</dl>
<h2 id="examples">Examples</h2>
<p><strong>Processes Lambda's event with PartialSQSProcessor</strong></p>
<pre><code>&gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import sqs_batch_processor
&gt;&gt;&gt;
&gt;&gt;&gt; def record_handler(record):
&gt;&gt;&gt;      return record["body"]
&gt;&gt;&gt;
&gt;&gt;&gt; @sqs_batch_processor(record_handler=record_handler)
&gt;&gt;&gt; def handler(event, context):
&gt;&gt;&gt;     return {"StatusCode": 200}
</code></pre>
<h2 id="limitations">Limitations</h2>
<ul>
<li>Async batch processors</li>
</ul></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@lambda_handler_decorator
def sqs_batch_processor(
    handler: Callable,
    event: Dict,
    context: Dict,
    record_handler: Callable,
    config: Optional[Config] = None,
    suppress_exception: bool = False,
    boto3_session: Optional[boto3.session.Session] = None,
):
    &#34;&#34;&#34;
    Middleware to handle SQS batch event processing

    Parameters
    ----------
    handler: Callable
        Lambda&#39;s handler
    event: Dict
        Lambda&#39;s Event
    context: Dict
        Lambda&#39;s Context
    record_handler: Callable
        Callable to process each record from the batch
    config: Config
            botocore config object
    suppress_exception: bool, optional
        Supress exception raised if any messages fail processing, by default False
    boto3_session : boto3.session.Session, optional
            Boto3 session to use for AWS API communication

    Examples
    --------
    **Processes Lambda&#39;s event with PartialSQSProcessor**

        &gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import sqs_batch_processor
        &gt;&gt;&gt;
        &gt;&gt;&gt; def record_handler(record):
        &gt;&gt;&gt;      return record[&#34;body&#34;]
        &gt;&gt;&gt;
        &gt;&gt;&gt; @sqs_batch_processor(record_handler=record_handler)
        &gt;&gt;&gt; def handler(event, context):
        &gt;&gt;&gt;     return {&#34;StatusCode&#34;: 200}

    Limitations
    -----------
    * Async batch processors

    &#34;&#34;&#34;
    config = config or Config()
    session = boto3_session or boto3.session.Session()

    processor = PartialSQSProcessor(config=config, suppress_exception=suppress_exception, boto3_session=session)

    records = event[&#34;Records&#34;]

    with processor(records, record_handler):
        processor.process()

    return handler(event, context)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="aws_lambda_powertools.utilities.batch.BasePartialProcessor"><code class="flex name class">
<span>class <span class="ident">BasePartialProcessor</span></span>
</code></dt>
<dd>
<div class="desc"><p>Abstract class for batch processors.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class BasePartialProcessor(ABC):
    &#34;&#34;&#34;
    Abstract class for batch processors.
    &#34;&#34;&#34;

    def __init__(self):
        self.success_messages: List = []
        self.fail_messages: List = []
        self.exceptions: List = []

    @abstractmethod
    def _prepare(self):
        &#34;&#34;&#34;
        Prepare context manager.
        &#34;&#34;&#34;
        raise NotImplementedError()

    @abstractmethod
    def _clean(self):
        &#34;&#34;&#34;
        Clear context manager.
        &#34;&#34;&#34;
        raise NotImplementedError()

    @abstractmethod
    def _process_record(self, record: Any):
        &#34;&#34;&#34;
        Process record with handler.
        &#34;&#34;&#34;
        raise NotImplementedError()

    def process(self) -&gt; List[Tuple]:
        &#34;&#34;&#34;
        Call instance&#39;s handler for each record.
        &#34;&#34;&#34;
        return [self._process_record(record) for record in self.records]

    def __enter__(self):
        self._prepare()
        return self

    def __exit__(self, exception_type, exception_value, traceback):
        self._clean()

    def __call__(self, records: List[Any], handler: Callable):
        &#34;&#34;&#34;
        Set instance attributes before execution

        Parameters
        ----------
        records: List[Any]
            List with objects to be processed.
        handler: Callable
            Callable to process &#34;records&#34; entries.
        &#34;&#34;&#34;
        self.records = records
        self.handler = handler
        return self

    def success_handler(self, record: Any, result: Any):
        &#34;&#34;&#34;
        Success callback

        Returns
        -------
        tuple
            &#34;success&#34;, result, original record
        &#34;&#34;&#34;
        entry = (&#34;success&#34;, result, record)
        self.success_messages.append(record)
        return entry

    def failure_handler(self, record: Any, exception: Tuple):
        &#34;&#34;&#34;
        Failure callback

        Returns
        -------
        tuple
            &#34;fail&#34;, exceptions args, original record
        &#34;&#34;&#34;
        exception_string = f&#34;{exception[0]}:{exception[1]}&#34;
        entry = (&#34;fail&#34;, exception_string, record)
        logger.debug(f&#34;Record processing exception: {exception_string}&#34;)
        self.exceptions.append(exception)
        self.fail_messages.append(record)
        return entry</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="aws_lambda_powertools.utilities.batch.sqs.PartialSQSProcessor" href="sqs.html#aws_lambda_powertools.utilities.batch.sqs.PartialSQSProcessor">PartialSQSProcessor</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="aws_lambda_powertools.utilities.batch.BasePartialProcessor.failure_handler"><code class="name flex">
<span>def <span class="ident">failure_handler</span></span>(<span>self, record: Any, exception: Tuple[])</span>
</code></dt>
<dd>
<div class="desc"><p>Failure callback</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>"fail", exceptions args, original record</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def failure_handler(self, record: Any, exception: Tuple):
    &#34;&#34;&#34;
    Failure callback

    Returns
    -------
    tuple
        &#34;fail&#34;, exceptions args, original record
    &#34;&#34;&#34;
    exception_string = f&#34;{exception[0]}:{exception[1]}&#34;
    entry = (&#34;fail&#34;, exception_string, record)
    logger.debug(f&#34;Record processing exception: {exception_string}&#34;)
    self.exceptions.append(exception)
    self.fail_messages.append(record)
    return entry</code></pre>
</details>
</dd>
<dt id="aws_lambda_powertools.utilities.batch.BasePartialProcessor.process"><code class="name flex">
<span>def <span class="ident">process</span></span>(<span>self) ‑> List[Tuple[]]</span>
</code></dt>
<dd>
<div class="desc"><p>Call instance's handler for each record.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def process(self) -&gt; List[Tuple]:
    &#34;&#34;&#34;
    Call instance&#39;s handler for each record.
    &#34;&#34;&#34;
    return [self._process_record(record) for record in self.records]</code></pre>
</details>
</dd>
<dt id="aws_lambda_powertools.utilities.batch.BasePartialProcessor.success_handler"><code class="name flex">
<span>def <span class="ident">success_handler</span></span>(<span>self, record: Any, result: Any)</span>
</code></dt>
<dd>
<div class="desc"><p>Success callback</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple</code></dt>
<dd>"success", result, original record</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def success_handler(self, record: Any, result: Any):
    &#34;&#34;&#34;
    Success callback

    Returns
    -------
    tuple
        &#34;success&#34;, result, original record
    &#34;&#34;&#34;
    entry = (&#34;success&#34;, result, record)
    self.success_messages.append(record)
    return entry</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="aws_lambda_powertools.utilities.batch.PartialSQSProcessor"><code class="flex name class">
<span>class <span class="ident">PartialSQSProcessor</span></span>
<span>(</span><span>config: Optional[botocore.config.Config] = None, suppress_exception: bool = False, boto3_session: Optional[boto3.session.Session] = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Amazon SQS batch processor to delete successes from the Queue.</p>
<p>The whole batch will be processed, even if failures occur. After all records are processed,
SQSBatchProcessingError will be raised if there were any failures, causing messages to
be returned to the SQS queue. This behaviour can be disabled by passing suppress_exception.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>config</code></strong> :&ensp;<code>Config</code></dt>
<dd>botocore config object</dd>
<dt><strong><code>suppress_exception</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Supress exception raised if any messages fail processing, by default False</dd>
<dt><strong><code>boto3_session</code></strong> :&ensp;<code>boto3.session.Session</code>, optional</dt>
<dd>Boto3 session to use for AWS API communication</dd>
</dl>
<h2 id="example">Example</h2>
<p><strong>Process batch triggered by SQS</strong></p>
<pre><code>&gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import PartialSQSProcessor
&gt;&gt;&gt;
&gt;&gt;&gt; def record_handler(record):
&gt;&gt;&gt;     return record["body"]
&gt;&gt;&gt;
&gt;&gt;&gt; def handler(event, context):
&gt;&gt;&gt;     records = event["Records"]
&gt;&gt;&gt;     processor = PartialSQSProcessor()
&gt;&gt;&gt;
&gt;&gt;&gt;     with processor(records=records, handler=record_handler):
&gt;&gt;&gt;         result = processor.process()
&gt;&gt;&gt;
&gt;&gt;&gt;     # Case a partial failure occurred, all successful executions
&gt;&gt;&gt;     # have been deleted from the queue after context's exit.
&gt;&gt;&gt;
&gt;&gt;&gt;     return result
</code></pre>
<p>Initializes sqs client.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class PartialSQSProcessor(BasePartialProcessor):
    &#34;&#34;&#34;
    Amazon SQS batch processor to delete successes from the Queue.

    The whole batch will be processed, even if failures occur. After all records are processed,
    SQSBatchProcessingError will be raised if there were any failures, causing messages to
    be returned to the SQS queue. This behaviour can be disabled by passing suppress_exception.

    Parameters
    ----------
    config: Config
        botocore config object
    suppress_exception: bool, optional
        Supress exception raised if any messages fail processing, by default False
    boto3_session : boto3.session.Session, optional
            Boto3 session to use for AWS API communication


    Example
    -------
    **Process batch triggered by SQS**

        &gt;&gt;&gt; from aws_lambda_powertools.utilities.batch import PartialSQSProcessor
        &gt;&gt;&gt;
        &gt;&gt;&gt; def record_handler(record):
        &gt;&gt;&gt;     return record[&#34;body&#34;]
        &gt;&gt;&gt;
        &gt;&gt;&gt; def handler(event, context):
        &gt;&gt;&gt;     records = event[&#34;Records&#34;]
        &gt;&gt;&gt;     processor = PartialSQSProcessor()
        &gt;&gt;&gt;
        &gt;&gt;&gt;     with processor(records=records, handler=record_handler):
        &gt;&gt;&gt;         result = processor.process()
        &gt;&gt;&gt;
        &gt;&gt;&gt;     # Case a partial failure occurred, all successful executions
        &gt;&gt;&gt;     # have been deleted from the queue after context&#39;s exit.
        &gt;&gt;&gt;
        &gt;&gt;&gt;     return result

    &#34;&#34;&#34;

    def __init__(
        self,
        config: Optional[Config] = None,
        suppress_exception: bool = False,
        boto3_session: Optional[boto3.session.Session] = None,
    ):
        &#34;&#34;&#34;
        Initializes sqs client.
        &#34;&#34;&#34;
        config = config or Config()
        session = boto3_session or boto3.session.Session()
        self.client = session.client(&#34;sqs&#34;, config=config)
        self.suppress_exception = suppress_exception

        super().__init__()

    def _get_queue_url(self) -&gt; Optional[str]:
        &#34;&#34;&#34;
        Format QueueUrl from first records entry
        &#34;&#34;&#34;
        if not getattr(self, &#34;records&#34;, None):
            return None

        *_, account_id, queue_name = self.records[0][&#34;eventSourceARN&#34;].split(&#34;:&#34;)
        return f&#34;{self.client._endpoint.host}/{account_id}/{queue_name}&#34;

    def _get_entries_to_clean(self) -&gt; List:
        &#34;&#34;&#34;
        Format messages to use in batch deletion
        &#34;&#34;&#34;
        return [{&#34;Id&#34;: msg[&#34;messageId&#34;], &#34;ReceiptHandle&#34;: msg[&#34;receiptHandle&#34;]} for msg in self.success_messages]

    def _process_record(self, record) -&gt; Tuple:
        &#34;&#34;&#34;
        Process a record with instance&#39;s handler

        Parameters
        ----------
        record: Any
            An object to be processed.
        &#34;&#34;&#34;
        try:
            result = self.handler(record=record)
            return self.success_handler(record=record, result=result)
        except Exception:
            return self.failure_handler(record=record, exception=sys.exc_info())

    def _prepare(self):
        &#34;&#34;&#34;
        Remove results from previous execution.
        &#34;&#34;&#34;
        self.success_messages.clear()
        self.fail_messages.clear()

    def _clean(self):
        &#34;&#34;&#34;
        Delete messages from Queue in case of partial failure.
        &#34;&#34;&#34;
        # If all messages were successful, fall back to the default SQS -
        # Lambda behaviour which deletes messages if Lambda responds successfully
        if not self.fail_messages:
            logger.debug(f&#34;All {len(self.success_messages)} records successfully processed&#34;)
            return

        queue_url = self._get_queue_url()
        entries_to_remove = self._get_entries_to_clean()

        delete_message_response = None
        if entries_to_remove:
            delete_message_response = self.client.delete_message_batch(QueueUrl=queue_url, Entries=entries_to_remove)

        if self.suppress_exception:
            logger.debug(f&#34;{len(self.fail_messages)} records failed processing, but exceptions are suppressed&#34;)
        else:
            logger.debug(f&#34;{len(self.fail_messages)} records failed processing, raising exception&#34;)
            raise SQSBatchProcessingError(
                msg=f&#34;Not all records processed successfully. {len(self.exceptions)} individual errors logged &#34;
                f&#34;separately below.&#34;,
                child_exceptions=self.exceptions,
            )

        return delete_message_response</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor">BasePartialProcessor</a></li>
<li>abc.ABC</li>
</ul>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor">BasePartialProcessor</a></b></code>:
<ul class="hlist">
<li><code><a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.failure_handler" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.failure_handler">failure_handler</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.process" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.process">process</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.success_handler" href="base.html#aws_lambda_powertools.utilities.batch.base.BasePartialProcessor.success_handler">success_handler</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="aws_lambda_powertools.utilities" href="../index.html">aws_lambda_powertools.utilities</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="aws_lambda_powertools.utilities.batch.base" href="base.html">aws_lambda_powertools.utilities.batch.base</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.exceptions" href="exceptions.html">aws_lambda_powertools.utilities.batch.exceptions</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.sqs" href="sqs.html">aws_lambda_powertools.utilities.batch.sqs</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="aws_lambda_powertools.utilities.batch.batch_processor" href="#aws_lambda_powertools.utilities.batch.batch_processor">batch_processor</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.sqs_batch_processor" href="#aws_lambda_powertools.utilities.batch.sqs_batch_processor">sqs_batch_processor</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="aws_lambda_powertools.utilities.batch.BasePartialProcessor" href="#aws_lambda_powertools.utilities.batch.BasePartialProcessor">BasePartialProcessor</a></code></h4>
<ul class="">
<li><code><a title="aws_lambda_powertools.utilities.batch.BasePartialProcessor.failure_handler" href="#aws_lambda_powertools.utilities.batch.BasePartialProcessor.failure_handler">failure_handler</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.BasePartialProcessor.process" href="#aws_lambda_powertools.utilities.batch.BasePartialProcessor.process">process</a></code></li>
<li><code><a title="aws_lambda_powertools.utilities.batch.BasePartialProcessor.success_handler" href="#aws_lambda_powertools.utilities.batch.BasePartialProcessor.success_handler">success_handler</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="aws_lambda_powertools.utilities.batch.PartialSQSProcessor" href="#aws_lambda_powertools.utilities.batch.PartialSQSProcessor">PartialSQSProcessor</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>